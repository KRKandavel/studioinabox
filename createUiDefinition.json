{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {
                "name": "stackName",
                "type": "Microsoft.Common.TextBox",
                "label": "Stack name",
                "toolTip": "The name of the Stack name.",
                "defaultValue": "Perforce-Studio-In-A-Box",
                "constraints": {
                    "required": true,
                    "regex": "^[a-z0-9A-Z-]{3,79}$",
                    "validationMessage": "The Stack name must be between 3 and 79 characters long and contain letters, numbers and hyphens only."
                }
            },
            {
                "name": "availabilityOption",
                "type": "Microsoft.Common.DropDown",
                "label": "Availability Options",
                "defaultValue": "No infrastructure redundancy required",
                "toolTip": "Select either Region or Zone.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "No infrastructure redundancy required",
                            "value": "region"
                        },
                        {
                            "label": "Availability zone",
                            "value": "zone"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
            {
                "name": "primaryZone",
                "type": "Microsoft.Common.DropDown",
                "label": "Number of primary zone",
                "defaultValue": "1",
                "toolTip": "Specify the number of primary zone data nodes for this deployment.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "1",
                            "value": "1"
                        },
                        {
                            "label": "2",
                            "value": "2"
                        }
                    ]
                },
                "visible": "[equals(basics('availabilityOption'), 'zone')]"
            },
            {
                "name": "secondaryZone",
                "type": "Microsoft.Common.DropDown",
                "label": "Number of secondary zone",
                "defaultValue": "1",
                "toolTip": "Specify the number of secondary zone data nodes for this deployment.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "1",
                            "value": "1"
                        },
                        {
                            "label": "2",
                            "value": "2"
                        }
                    ]
                },
                "visible": "[equals(basics('availabilityOption'), 'zone')]"
            }
        ],
        "steps": [
            {
                "name": "VirtualNetworkConfig",
                "label": "Virtual Network Configuration",
                "subLabel": {
                    "preValidation": "Configure the virtual network's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Virtual Machine Settings",
                "elements": [
                    {
                        "name": "virtualNetwork",
                        "type": "Microsoft.Network.VirtualNetworkCombo",
                        "label": {
                            "virtualNetwork": "Virtual network",
                            "subnets": "Subnets"
                        },
                        "toolTip": {
                            "virtualNetwork": "Name of the virtual network",
                            "subnets": "Subnets for the virtual network"
                        },
                        "defaultValue": {
                            "name": "VirtualNetwork",
                            "addressPrefixSize": "/16"
                        },
                        "constraints": {
                            "minAddressPrefixSize": "/16"
                        },
                        "subnets": {
                            "subnet1": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PublicSubnet0",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet2": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PublicSubnet1",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet3": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PrivateSubnet0",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet4": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PrivateSubnet1",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            }
                        }
                    },
                    {
                        "name": "ipRangeToPermitFrom",
                        "type": "Microsoft.Common.TextBox",
                        "label": "IP range to Permit from",
                        "defaultValue": "1.1.1.1/32",
                        "toolTip": "Input your public IP address in CIDR notation. Example: 162.244.43.80/32. Use a service like whatismyipaddress.com to find your public IP address.",
                        "constraints": {
                            "required": true,
                            "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\/(\\d|[1-2]\\d|3[0-2])$",
                            "validationMessage": "IP range must be a valid CIDR range of the form x.x.x.x/x"
                        }
                    }
                ]
            },
            {
                "name": "PerforceServerConfig",
                "label": "Perforce Server Configuration",
                "subLabel": {
                    "preValidation": "Configure the Perforce Server's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Perforce Server Configuration",
                "elements": [
                    {
                        "name": "adminUsername",
                        "type": "Microsoft.Compute.UserNameTextBox",
                        "label": "Username",
                        "toolTip": "Admin username for the machine",
                        "osPlatform": "Linux",
                        "constraints": {
                            "required": true
                        }
                    },
                    {
                        "name": "sshKeyPairCredentials",
                        "type": "Microsoft.Compute.CredentialsCombo",
                        "label": {
                            "authenticationType": "Authentication type",
                            "password": "Password",
                            "confirmPassword": "Confirm password",
                            "sshPublicKey": "SSH public key"
                        },
                        "toolTip": {
                            "authenticationType": "Authentication Type for Perforce Server",
                            "password": "Password for the Perforce Server",
                            "sshPublicKey": "SSH Public Key for the Perforce Server"
                        },
                        "constraints": {
                            "required": true
                        },
                        "options": {
                            "hidePassword": true,
                            "hideConfirmation": true
                        },
                        "osPlatform": "Linux"
                    },
                    {
                        "name": "p4VMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "P4 instance type",
                        "toolTip": "Select P4 server VM SKU",
                        "recommendedSizes": [
                            "Standard_D1_v2",
                            "Standard_D2_v2",
                            "Standard_D3_v2",
                            "Standard_D4_v2",
                            "Standard_D5_v2"
                        ],
                        "constraints": {
                            "allowedSizes": [
                                "Standard_A1_v2",
                                "Standard_A2_v2",
                                "Standard_A4_v2",
                                "Standard_A8_v2",
                                "Standard_A2m_v2",
                                "Standard_A4m_v2",
                                "Standard_A8m_v2",
                                "Standard_D1_v2",
                                "Standard_D2_v2",
                                "Standard_D3_v2",
                                "Standard_D4_v2",
                                "Standard_D5_v2",
                                "Standard_D11_v2",
                                "Standard_D12_v2",
                                "Standard_D13_v2",
                                "Standard_D14_v2",
                                "Standard_D15_v2"
                            ]
                        },
                        "osPlatform": "Linux",
                        "count": "1",
                        "visible": true
                    },
                    {
                        "name": "p4OSType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select OS type for P4",
                        "defaultValue": "1",
                        "toolTip": "Specify the operating system for P4 Virtual Machine.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Ubuntu 18.04 LTS",
                                    "value": "Ubuntu 18.04 LTS"
                                },
                                {
                                    "label": "CentOS 7.x",
                                    "value": "CentOS 7.x"
                                },
                                {
                                    "label": "RHEL 7.x",
                                    "value": "RHEL 7.x"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "deployFromScratchOrSnapshot",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy P4 From Scratch/Snapshot",
                        "defaultValue": "Scratch",
                        "toolTip": "Select to choose from scratch or snapshot",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Scratch",
                                    "value": "scratch"
                                },
                                {
                                    "label": "Snapshot",
                                    "value": "snapshot"
                                }
                            ]
                        }
                    },
                    {
                        "name": "p4SnapshotIDArchive",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "P4 Snapshot for Archive",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDJournal",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "P4 Snapshot for Journal",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDLog",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "P4 Snapshot for Log",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDMetadata",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "P4 Snapshot for Metadata",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "depotVolumeType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Type of managed disks",
                        "visible": "",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select either Standard HDD or Standard SSD.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "Standard_HDD"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "Standard_SSD"
                                }
                            ]
                        }
                    },
                    {
                        "name": "depotVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Depot volume size",
                        "defaultValue": "512",
                        "toolTip": "The size (GB) of the Managed disk attached for Depot.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "logVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Log volume size",
                        "defaultValue": "50",
                        "toolTip": "The size (GB) of the Managed disk attached for Log.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "logVolumeType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Type of managed disks",
                        "visible": "",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select either Standard HDD or Standard SSD.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "Standard_HDD"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "Standard_SSD"
                                }
                            ]
                        }
                    },
                    {
                        "name": "metadataVolumeType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Type of managed disks",
                        "visible": "",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select either Standard HDD or Standard SSD.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "Standard_HDD"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "Standard_SSD"
                                }
                            ]
                        }
                    },
                    {
                        "name": "metadataVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Metadata volume size",
                        "defaultValue": "64",
                        "toolTip": "The size (GB) of the Managed disk attached for Log.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "metadataProvisionedIOPS",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Metadata provisioned IOPS",
                        "defaultValue": "100",
                        "toolTip": "Set the provisioned IOPs between 100 and 64000. Only set if you are choosing io1, io2, or gp3 for your metadata volume type. If using gp2 leave empty.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "journalVolumeType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Type of managed disks",
                        "visible": "",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select either Standard HDD or Standard SSD.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "Standard_HDD"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "Standard_SSD"
                                }
                            ]
                        }
                    },
                    {
                        "name": "journalVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Journal volume size",
                        "defaultValue": "64",
                        "toolTip": "The size (GB) of the Managed disk attached for Log.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "journalProvisionedIOPS",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Journal provisioned IOPS",
                        "defaultValue": "100",
                        "toolTip": "Set the provisioned IOPs between 100 and 64000. Only set if you are choosing io1, io2, or gp3 for your metadata volume type. If using gp2 leave empty.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "p4PreUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Pre Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run before the default P4 userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": false,
                            "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                            "validationMessage": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                        }
                    },
                    {
                        "name": "p4PostUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Post Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run after the default P4 userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": false,
                            "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                            "validationMessage": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                        }
                    }
                ]
            },
            {
                "name": "WindowsWorkstationConfig",
                "label": "Windows Workstation Configuration",
                "subLabel": {
                    "preValidation": "Configure the Windows Workstation's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Windows Workstation Configuration",
                "elements": [
                    {
                        "name": "deployWindowsWorkstation",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Windows Workstation",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy the Windows Workstation",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": "true"
                                },
                                {
                                    "label": "false",
                                    "value": "false"
                                }
                            ]
                        }
                    },
                    {
                        "name": "windowsVMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "Windows instance type",
                        "toolTip": "Select Windows Workstation VM SKU",
                        "recommendedSizes": [
                            "Standard_D1_v2",
                            "Standard_D2_v2",
                            "Standard_D3_v2",
                            "Standard_D4_v2",
                            "Standard_D5_v2"
                        ],
                        "constraints": {
                            "allowedSizes": [
                                "Standard_A1_v2",
                                "Standard_A2_v2",
                                "Standard_A4_v2",
                                "Standard_A8_v2",
                                "Standard_A2m_v2",
                                "Standard_A4m_v2",
                                "Standard_A8m_v2",
                                "Standard_D1_v2",
                                "Standard_D2_v2",
                                "Standard_D3_v2",
                                "Standard_D4_v2",
                                "Standard_D5_v2",
                                "Standard_D11_v2",
                                "Standard_D12_v2",
                                "Standard_D13_v2",
                                "Standard_D14_v2",
                                "Standard_D15_v2"
                            ]
                        },
                        "osPlatform": "Windows",
                        "count": "1",
                        "visible": true
                    },
                    {
                        "name": "windowsOSType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select OS type for Workstation",
                        "defaultValue": "Windows Server 2019",
                        "toolTip": "Specify the operating system for Workstation Virtual Machine.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Windows Server 2019",
                                    "value": "Windows Server 2019"
                                },
                                {
                                    "label": "Windows Server 2016",
                                    "value": "Windows Server 2019"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "windowsAdminPassword",
                        "type": "Microsoft.Common.PasswordBox",
                        "label": {
                            "password": "'azureuser' built-in user password",
                            "confirmPassword": "Confirm password"
                        },
                        "toolTip": "Password for the built-in 'azureuser' user. This is a built-in superuser account with unlimited access",
                        "constraints": {
                            "required": true,
                            "regex": "^.{12,}",
                            "validationMessage": "Password must be at least 12 characters long"
                        },
                        "options": {
                            "hideConfirmation": false
                        }
                    },
                    {
                        "name": "windowsRootVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Windows instance root volume size",
                        "defaultValue": "150",
                        "toolTip": "Provide the size of the root volume - The size (GB) of the Managed disk.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "windowsPreUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Pre Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run before the default Workstation userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "windowsPostUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Post Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run after the default Workstation userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "HansoftConfig",
                "label": "Hansoft Configuration",
                "subLabel": {
                    "preValidation": "Configure the Hansoft resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Hansoft Configuration",
                "elements": [
                    {
                        "name": "deployHansoft",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Hansoft",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy Hansoft",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": "true"
                                },
                                {
                                    "label": "false",
                                    "value": "false"
                                }
                            ]
                        }
                    },
                    {
                        "name": "hansoftVMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "Hansoft instance type",
                        "toolTip": "Select Hansoft VM SKU",
                        "recommendedSizes": [
                            "Standard_F8s_v2",
                            "Standard_F16s_v2"
                        ],
                        "osPlatform": "Linux",
                        "count": "1"
                    },
                    {
                        "name": "hansoftOSType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select OS type for Hansoft",
                        "defaultValue": "Ubuntu 18.04 LTS",
                        "toolTip": "Specify the operating system for Hansoft Virtual Machine.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Ubuntu 18.04 LTS",
                                    "value": "Ubuntu 18.04 LTS"
                                },
                                {
                                    "label": "CentOS 7.x",
                                    "value": "CentOS 7.x"
                                },
                                {
                                    "label": "RHEL 7.x",
                                    "value": "RHEL 7.x"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "hansoftRootVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Hansoft instance root volume size",
                        "defaultValue": "100",
                        "toolTip": "Provide the size of the Hansoft root volume - The size (GB) of the Managed disk.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "hansoftPreUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Pre Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run before the default Hansoft userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "hansoftPostUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Post Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run after the default Hansoft userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "SwarmConfig",
                "label": "Swarm Configuration",
                "subLabel": {
                    "preValidation": "Configure the Swarm resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Swarm Configuration",
                "elements": [
                    {
                        "name": "deploySwarm",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Swarm",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy Swarm",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": "true"
                                },
                                {
                                    "label": "false",
                                    "value": "false"
                                }
                            ]
                        }
                    },
                    {
                        "name": "swarmVMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "Swarm instance type",
                        "toolTip": "Select Swarm VM SKU",
                        "recommendedSizes": [
                            "Standard_D1_v2",
                            "Standard_D2_v2",
                            "Standard_D3_v2",
                            "Standard_D4_v2",
                            "Standard_D5_v2"
                        ],
                        "constraints": {
                            "allowedSizes": [
                                "Standard_A1_v2",
                                "Standard_A2_v2",
                                "Standard_A4_v2",
                                "Standard_A8_v2",
                                "Standard_A2m_v2",
                                "Standard_A4m_v2",
                                "Standard_A8m_v2",
                                "Standard_D1_v2",
                                "Standard_D2_v2",
                                "Standard_D3_v2",
                                "Standard_D4_v2",
                                "Standard_D5_v2",
                                "Standard_D11_v2",
                                "Standard_D12_v2",
                                "Standard_D13_v2",
                                "Standard_D14_v2",
                                "Standard_D15_v2"
                            ]
                        },
                        "osPlatform": "Linux",
                        "count": "1",
                        "visible": true
                    },
                    {
                        "name": "swarmOSType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Select OS type for Swarm",
                        "defaultValue": "Ubuntu 18.04 LTS",
                        "toolTip": "Specify the operating system for Swarm Virtual Machine.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Ubuntu 18.04 LTS",
                                    "value": "Ubuntu 18.04 LTS"
                                },
                                {
                                    "label": "CentOS 7.x",
                                    "value": "CentOS 7.x"
                                },
                                {
                                    "label": "RHEL 7.x",
                                    "value": "RHEL 7.x"
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "swarmRootVolumeSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Swarm instance root volume size",
                        "defaultValue": "100",
                        "toolTip": "Provide the size of the Swarm root volume - The size (GB) of the Managed disk.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        }
                    },
                    {
                        "name": "swarmPreUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Pre Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run before the default Swarm userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "swarmPostUserdata",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Post Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run after the default Swarm userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "constraints": {
                            "required": true,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "OtherParams",
                "label": "Other parameters",
                "subLabel": {
                    "preValidation": "Configure the Other parameters and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Other parameters",
                "elements": [
                    {
                        "name": "environment",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Environment",
                        "defaultValue": "dev",
                        "toolTip": "Provide an environment name that will be used in resource names and tagging. Min 3, max 20",
                        "constraints": {
                            "required": true,
                            "regex": "^[0-9a-zA-Z][0-9a-zA-Z\\-]{0,4}$",
                            "validationMessage": "Environment must start with an alphanumeric character and can contain alphanumeric or hyphen characters, up to 5 characters in length"
                        }
                    }
                ]
            }
        ],
        "outputs": {
            "location": "[location()]",
            "stackName": "[basics('stackName')]",
            "primaryZone": "[basics('primaryZone')]",
            "secondaryZone": "[basics('secondaryZone')]",
            "vnetNewOrExisting": "[steps('VirtualNetworkConfig').virtualNetwork.newOrExisting]",
            "vnetName": "[steps('VirtualNetworkConfig').virtualNetwork.name]",
            "vnetAddressPrefixes": "[steps('VirtualNetworkConfig').virtualNetwork.addressPrefixes]",
            "publicSubnet0Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet1.name]",
            "publicSubnet0": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet1.addressPrefix]",
            "publicSubnet1Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet2.name]",
            "publicSubnet1": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet2.addressPrefix]",
            "privateSubnet0Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet3.name]",
            "privateSubnet0": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet3.addressPrefix]",
            "privateSubnet1Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet4.name]",
            "privateSubnet1": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet4.addressPrefix]",
            "vnetResourceGroupName": "[steps('VirtualNetworkConfig').virtualNetwork.resourceGroup]",
            "nsgIPRangeToPermit": "[steps('VirtualNetworkConfig').ipRangeToPermitFrom]",
            "adminUsername": "[steps('PerforceServerConfig').adminUsername]",
            "authenticationType": "[steps('PerforceServerConfig').sshKeyPairCredentials.authenticationType]",
            "adminPasswordOrKey": "[coalesce(steps('PerforceServerConfig').sshKeyPairCredentials.password, steps('PerforceServerConfig').sshKeyPairCredentials.sshPublicKey)]",
            "p4VMSize": "[steps('PerforceServerConfig').p4VMSize]",
            "p4OSType": "[steps('PerforceServerConfig').p4OSType]",
            "deployFromScratchOrSnapshot": "[steps('PerforceServerConfig').deployFromScratchOrSnapshot]",
            "p4SnapshotIDArchive": "[steps('PerforceServerConfig').p4SnapshotIDArchive.id]",
            "p4SnapshotIDJournal": "[steps('PerforceServerConfig').p4SnapshotIDJournal.id]",
            "p4SnapshotIDLog": "[steps('PerforceServerConfig').p4SnapshotIDLog.id]",
            "p4SnapshotIDMetadata": "[steps('PerforceServerConfig').p4SnapshotIDMetadata.id]",
            "depotVolumeType": "[steps('PerforceServerConfig').depotVolumeType]",
            "depotVolumeSize": "[steps('PerforceServerConfig').depotVolumeSize]",
            "logVolumeType": "[steps('PerforceServerConfig').logVolumeType]",
            "logVolumeSize": "[steps('PerforceServerConfig').logVolumeSize]",
            "metadataVolumeType": "[steps('PerforceServerConfig').metadataVolumeType]",
            "metadataVolumeSize": "[steps('PerforceServerConfig').metadataVolumeSize]",
            "metadataProvisionedIOPS": "[steps('PerforceServerConfig').metadataProvisionedIOPS]",
            "journalVolumeType": "[steps('PerforceServerConfig').journalVolumeType]",
            "journalVolumeSize": "[steps('PerforceServerConfig').journalVolumeSize]",
            "journalProvisionedIOPS": "[steps('PerforceServerConfig').journalProvisionedIOPS]",
            "p4PreUserdata": "[steps('PerforceServerConfig').p4PreUserdata]",
            "p4PostUserdata": "[steps('PerforceServerConfig').p4PostUserdata]",
            "deployHansoft": "[steps('HansoftConfig').deployHansoft]",
            "hansoftVMSize": "[steps('HansoftConfig').hansoftVMSize]",
            "hansoftOSType": "[steps('HansoftConfig').hansoftOSType]",
            "hansoftRootVolumeSize": "[steps('HansoftConfig').hansoftRootVolumeSize]",
            "hansoftPreUserdata": "[steps('HansoftConfig').hansoftPreUserdata]",
            "hansoftPostUserdata": "[steps('HansoftConfig').hansoftPostUserdata]",
            "swarmVMSize": "[steps('SwarmConfig').swarmVMSize]",
            "swarmOSType": "[steps('SwarmConfig').swarmOSType]",
            "swarmRootVolumeSize": "[steps('SwarmConfig').swarmRootVolumeSize]",
            "swarmPreUserdata": "[steps('SwarmConfig').swarmPreUserdata]",
            "swarmPostUserdata": "[steps('SwarmConfig').swarmPostUserdata]",
            "deployWindowsWorkstation": "[steps('WindowsWorkstationConfig').deployWindowsWorkstation]",
            "windowsVMSize": "[steps('WindowsWorkstationConfig').windowsVMSize]",
            "windowsOSType": "[steps('WindowsWorkstationConfig').windowsOSType]",
            "windowsAdminPassword": "[steps('WindowsWorkstationConfig').windowsAdminPassword]",
            "windowsRootVolumeSize": "[steps('WindowsWorkstationConfig').windowsRootVolumeSize]",
            "windowsPreUserdata": "[steps('WindowsWorkstationConfig').windowsPreUserdata]",
            "windowsPostUserdata": "[steps('WindowsWorkstationConfig').windowsPostUserdata]",
            "environment": "[steps('OtherParams').environment]"
        }
    }
}