{
    "$schema": "https://schema.management.azure.com/schemas/0.1.2-preview/CreateUIDefinition.MultiVm.json#",
    "handler": "Microsoft.Azure.CreateUIDef",
    "version": "0.1.2-preview",
    "parameters": {
        "basics": [
            {
                "name": "environment",
                "type": "Microsoft.Common.TextBox",
                "label": "Environment",
                "defaultValue": "dev",
                "toolTip": "Provide an environment name that will be used in resource names and tagging. Min 3, max 20",
                "constraints": {
                    "required": true,
                    "regex": "^[0-9a-zA-Z][0-9a-zA-Z\\-]{0,4}$",
                    "validationMessage": "Environment must start with an alphanumeric character and can contain alphanumeric or hyphen characters, up to 5 characters in length"
                }
            },
            {
                "name": "availabilityOption",
                "type": "Microsoft.Common.DropDown",
                "label": "Availability Options",
                "defaultValue": "No infrastructure redundancy required",
                "toolTip": "Select either Region or Zone.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "No infrastructure redundancy required",
                            "value": "region"
                        },
                        {
                            "label": "Availability zone",
                            "value": "zone"
                        }
                    ],
                    "required": true
                },
                "visible": true
            },
            {
                "name": "primaryZone",
                "type": "Microsoft.Common.DropDown",
                "label": "Number of primary zone",
                "defaultValue": "1",
                "toolTip": "Specify the number of primary zone data nodes for this deployment.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "1",
                            "value": "1"
                        },
                        {
                            "label": "2",
                            "value": "2"
                        }
                    ]
                },
                "visible": "[equals(basics('availabilityOption'), 'zone')]"
            },
            {
                "name": "secondaryZone",
                "type": "Microsoft.Common.DropDown",
                "label": "Number of secondary zone",
                "defaultValue": "1",
                "toolTip": "Specify the number of secondary zone data nodes for this deployment.",
                "constraints": {
                    "allowedValues": [
                        {
                            "label": "1",
                            "value": "1"
                        },
                        {
                            "label": "2",
                            "value": "2"
                        }
                    ]
                },
                "visible": "[equals(basics('availabilityOption'), 'zone')]"
            }
        ],
        "steps": [
            {
                "name": "VirtualNetworkConfig",
                "label": "Virtual Network Configuration",
                "subLabel": {
                    "preValidation": "Configure the virtual network's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Virtual Machine Settings",
                "elements": [
                    {
                        "name": "virtualNetwork",
                        "type": "Microsoft.Network.VirtualNetworkCombo",
                        "label": {
                            "virtualNetwork": "Virtual network",
                            "subnets": "Subnets"
                        },
                        "toolTip": {
                            "virtualNetwork": "Name of the virtual network",
                            "subnets": "Subnets for the virtual network"
                        },
                        "defaultValue": {
                            "name": "HXVNET",
                            "addressPrefixSize": "/16"
                        },
                        "constraints": {
                            "minAddressPrefixSize": "/16"
                        },
                        "subnets": {
                            "subnet1": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PublicSubnet0",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet2": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PublicSubnet1",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet3": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PrivateSubnet0",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            },
                            "subnet4": {
                                "label": "Subnet",
                                "defaultValue": {
                                    "name": "PrivateSubnet1",
                                    "addressPrefixSize": "/24"
                                },
                                "constraints": {
                                    "minAddressPrefixSize": "/24",
                                    "minAddressCount": 12,
                                    "requireContiguousAddresses": false
                                }
                            }
                        }
                    },
                    {
                        "name": "ipRangeToPermitFrom",
                        "type": "Microsoft.Common.TextBox",
                        "label": "IP range to Permit from",
                        "defaultValue": "1.1.1.1/32",
                        "toolTip": "Input your public IP address in CIDR notation. Example: 162.244.43.80/32. Use a service like whatismyipaddress.com to find your public IP address.",
                        "constraints": {
                            "required": true,
                            "regex": "^(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)\/(\\d|[1-2]\\d|3[0-2])$",
                            "validationMessage": "IP range must be a valid CIDR range of the form x.x.x.x/x"
                        }
                    }
                ]
            },
            {
                "name": "PerforceServerConfig",
                "label": "Perforce Server Configuration",
                "subLabel": {
                    "preValidation": "Configure the Perforce Server's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Perforce Server Configuration",
                "elements": [
                    {
                        "name": "p4VMSize",
                        "type": "Microsoft.Compute.SizeSelector",
                        "label": "P4 instance type",
                        "toolTip": "Select P4 server VM SKU",
                        "recommendedSizes": [
                            "Standard_D1_v2",
                            "Standard_D2_v2",
                            "Standard_D3_v2",
                            "Standard_D4_v2",
                            "Standard_D5_v2"
                        ],
                        "constraints": {
                            "allowedSizes": [
                                "Standard_A1_v2",
                                "Standard_A2_v2",
                                "Standard_A4_v2",
                                "Standard_A8_v2",
                                "Standard_A2m_v2",
                                "Standard_A4m_v2",
                                "Standard_A8m_v2",
                                "Standard_D1_v2",
                                "Standard_D2_v2",
                                "Standard_D3_v2",
                                "Standard_D4_v2",
                                "Standard_D5_v2",
                                "Standard_D11_v2",
                                "Standard_D12_v2",
                                "Standard_D13_v2",
                                "Standard_D14_v2",
                                "Standard_D15_v2"
                            ]
                        },
                        "osPlatform": "Linux",
                        "count": "1",
                        "visible": true
                    },
                    {
                        "name": "linuxCredential",
                        "type": "Microsoft.Common.Section",
                        "label": "Linux Account Details",
                        "elements": [
                            {
                                "name": "p4SSHType",
                                "type": "Microsoft.Common.DropDown",
                                "label": "SSH public key source",
                                "defaultValue": "Use existing key stored in Azure",
                                "toolTip": "Specify the SSH key source for P4 server.",
                                "constraints": {
                                    "allowedValues": [
                                        {
                                            "label": "Use existing key stored in Azure",
                                            "value": "existingkey"
                                        },
                                        {
                                            "label": "Use existig public key",
                                            "value": "publickey"
                                        }
                                    ],
                                    "required": true
                                },
                                "visible": true
                            },
                            {
                                "name": "adminUsername",
                                "type": "Microsoft.Compute.UserNameTextBox",
                                "label": "User name",
                                "defaultValue": "perforce",
                                "toolTip": "Specify a user for accessing the virtual machines within your cluster. Must be a valid Ubuntu username",
                                "constraints": {
                                    "required": true,
                                    "regex": "^(?!(?:adm|admin|audio|backup|bin|cdrom|crontab|daemon|dialout|dip|disk|fax|floppy|fuse|games|gnats|irc|kmem|landscape|libuuid|list|lp|mail|man|messagebus|mlocate|netdev|news|nobody|nogroup|operator|plugdev|proxy|root|sasl|shadow|src|ssh|sshd|staff|sudo|sync|sys|syslog|tape|tty|users|utmp|uucp|video|voice|whoopsie|www\\-data)$)\\w+$",
                                    "validationMessage": "Username must not be a reserved Ubuntu username"
                                },
                                "visible": true,
                                "osPlatform": "Linux"
                            },
                            {
                                "name": "adminExistKey",
                                "type": "Microsoft.Solutions.ResourceSelector",
                                "label": "Key pair name",
                                "resourceType": "Microsoft.Compute/sshPublicKeys",
                                "toolTip": "Select new key pair stored in Azure",
                                "options": {
                                    "filter": {
                                        "subscription": "onBasics",
                                        "location": "onBasics"
                                    }
                                },
                                "constraints": {
                                    "required": true
                                },
                                "visible": "[equals(steps('PerforceServerConfig').linuxCredential.p4SSHType, 'existingkey')]"
                            },
                            {
                                "name": "adminPublicKey",
                                "type": "Microsoft.Compute.CredentialsCombo",
                                "label": {
                                    "authenticationType": "Authentication type",
                                    "password": "Password",
                                    "confirmPassword": "Confirm password",
                                    "sshPublicKey": "SSH public key"
                                },
                                "toolTip": {
                                    "authenticationType": "Choose Authentication type Password or PublicKey(SSH).",
                                    "password": "Enter the password for the specified user name.",
                                    "sshPublicKey": "Copy Public key into field."
                                },
                                "constraints": {
                                    "required": true
                                },
                                "options": {
                                    "hidePassword": true,
                                    "hideConfirmation": true
                                },
                                "osPlatform": "Linux",
                                "visible": "[equals(steps('PerforceServerConfig').linuxCredential.p4SSHType, 'publickey')]"
                            }
                        ]
                    },
                    {
                        "name": "deployFromScratchOrSnapshot",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy from Scratch/Snapshot",
                        "defaultValue": "Scratch",
                        "toolTip": "Select deploy option of scratch or snapshot",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Scratch",
                                    "value": "scratch"
                                },
                                {
                                    "label": "Snapshot",
                                    "value": "snapshot"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "p4SnapshotIDArchive",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "Snapshot for Archive",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "constraints": {
                            "required": true
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDJournal",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "Snapshot for Journal",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "constraints": {
                            "required": true
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDLog",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "Snapshot for Log",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "constraints": {
                            "required": true
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "p4SnapshotIDMetadata",
                        "type": "Microsoft.Solutions.ResourceSelector",
                        "label": "Snapshot for Metadata",
                        "resourceType": "Microsoft.Compute/snapshots",
                        "options": {
                            "filter": {
                                "subscription": "onBasics",
                                "location": "onBasics"
                            }
                        },
                        "constraints": {
                            "required": true
                        },
                        "visible": "[equals(steps('PerforceServerConfig').deployFromScratchOrSnapshot, 'snapshot')]"
                    },
                    {
                        "name": "depotDiskType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Disk type for Depot",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select disk type for Depot.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "StandardHDD_LRS"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "StandardSSD_LRS"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "depotDiskSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Disk size for Depot",
                        "defaultValue": "512",
                        "toolTip": "The size (GB) of the Managed disk attached to Depot.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        },
                        "visible": true
                    },
                    {
                        "name": "logDiskType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Disk type for Log",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select disk type for Log.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "StandardHDD_LRS"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "StandardSSD_LRS"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "logDiskSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Disk size for Log",
                        "defaultValue": "50",
                        "toolTip": "The size (GB) of the Managed disk attached to Log.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        },
                        "visible": true
                    },
                    {
                        "name": "metadataDiskType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Disk type for Metadata",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select disk type for Metadata.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "StandardHDD_LRS"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "StandardSSD_LRS"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "metadataDiskSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Disk size for Metadata",
                        "defaultValue": "64",
                        "toolTip": "The size (GB) of the Managed disk attached to Metadata.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        },
                        "visible": true
                    },
                    {
                        "name": "journalDiskType",
                        "type": "Microsoft.Common.DropDown",
                        "label": "Disk type for Journal",
                        "defaultValue": "Standard SSD",
                        "toolTip": "Select disk type for Journal.",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "Standard HDD",
                                    "value": "StandardHDD_LRS"
                                },
                                {
                                    "label": "Standard SSD",
                                    "value": "StandardSSD_LRS"
                                }
                            ],
                            "required": true
                        },
                        "visible": true
                    },
                    {
                        "name": "journalDiskSize",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Disk size for Journal",
                        "defaultValue": "64",
                        "toolTip": "The size (GB) of the Managed disk attached for Log.",
                        "constraints": {
                            "required": true,
                            "regex": "^\\d+$",
                            "validationMessage": "Value must be numeric and greater than or equal to 0"
                        },
                        "visible": true
                    },
                    {
                        "name": "p4PreUserData",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Pre Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run before the default P4 userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "multiLine": true,
                        "constraints": {
                            "required": false,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    },
                    {
                        "name": "p4PostUserData",
                        "type": "Microsoft.Common.TextBox",
                        "label": "Post Userdata",
                        "defaultValue": "",
                        "toolTip": "Userdata to run after the default P4 userdata.",
                        "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                        "multiLine": true,
                        "constraints": {
                            "required": false,
                            "validations": [
                                {
                                    "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                    "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                }
                            ]
                        },
                        "visible": true
                    }
                ]
            },
            {
                "name": "HansoftConfig",
                "label": "Hansoft Configuration",
                "subLabel": {
                    "preValidation": "Configure the Hansoft resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Hansoft Configuration",
                "elements": [
                    {
                        "name": "deployHansoft",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Hansoft",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy Hansoft",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": true
                                },
                                {
                                    "label": "false",
                                    "value": false
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "vmSettings",
                        "type": "Microsoft.Common.Section",
                        "label": "Hansoft VM Settings",
                        "elements": [
                            {
                                "name": "vmSize",
                                "type": "Microsoft.Compute.SizeSelector",
                                "label": "Hansoft instance type",
                                "toolTip": "Select Hansoft VM SKU",
                                "recommendedSizes": [
                                    "Standard_D1_v2",
                                    "Standard_D2_v2",
                                    "Standard_D3_v2",
                                    "Standard_D4_v2",
                                    "Standard_D5_v2"
                                ],
                                "constraints": {
                                    "allowedSizes": [
                                        "Standard_A1_v2",
                                        "Standard_A2_v2",
                                        "Standard_A4_v2",
                                        "Standard_A8_v2",
                                        "Standard_A2m_v2",
                                        "Standard_A4m_v2",
                                        "Standard_A8m_v2",
                                        "Standard_D1_v2",
                                        "Standard_D2_v2",
                                        "Standard_D3_v2",
                                        "Standard_D4_v2",
                                        "Standard_D5_v2",
                                        "Standard_D11_v2",
                                        "Standard_D12_v2",
                                        "Standard_D13_v2",
                                        "Standard_D14_v2",
                                        "Standard_D15_v2"
                                    ]
                                },
                                "osPlatform": "Linux",
                                "count": "1",
                                "visible": true
                            },
                            {
                                "name": "rootDiskSize",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Hansoft instance root disk size",
                                "defaultValue": "100",
                                "toolTip": "Provide the size of the Hansoft root disk - The size (GB) of the Managed disk.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^\\d+$",
                                    "validationMessage": "Value must be numeric and greater than or equal to 0"
                                }
                            },
                            {
                                "name": "preUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Pre Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run before the default Hansoft userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            },
                            {
                                "name": "postUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Post Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run after the default Hansoft userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            }
                        ],
                        "visible": "[steps('HansoftConfig').deployHansoft]"
                    }
                ]
            },
            {
                "name": "SwarmConfig",
                "label": "Swarm Configuration",
                "subLabel": {
                    "preValidation": "Configure the Swarm resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Swarm Configuration",
                "elements": [
                    {
                        "name": "deploySwarm",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Swarm",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy Swarm",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": true
                                },
                                {
                                    "label": "false",
                                    "value": false
                                }
                            ],
                            "required": true
                        }
                    },
                    {
                        "name": "vmSettings",
                        "type": "Microsoft.Common.Section",
                        "label": "Hansoft VM Settings",
                        "elements": [
                            {
                                "name": "vmSize",
                                "type": "Microsoft.Compute.SizeSelector",
                                "label": "Swarm instance type",
                                "toolTip": "Select Swarm VM SKU",
                                "recommendedSizes": [
                                    "Standard_D1_v2",
                                    "Standard_D2_v2",
                                    "Standard_D3_v2",
                                    "Standard_D4_v2",
                                    "Standard_D5_v2"
                                ],
                                "constraints": {
                                    "allowedSizes": [
                                        "Standard_A1_v2",
                                        "Standard_A2_v2",
                                        "Standard_A4_v2",
                                        "Standard_A8_v2",
                                        "Standard_A2m_v2",
                                        "Standard_A4m_v2",
                                        "Standard_A8m_v2",
                                        "Standard_D1_v2",
                                        "Standard_D2_v2",
                                        "Standard_D3_v2",
                                        "Standard_D4_v2",
                                        "Standard_D5_v2",
                                        "Standard_D11_v2",
                                        "Standard_D12_v2",
                                        "Standard_D13_v2",
                                        "Standard_D14_v2",
                                        "Standard_D15_v2"
                                    ]
                                },
                                "osPlatform": "Linux",
                                "count": "1",
                                "visible": true
                            },
                            {
                                "name": "rootDiskSize",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Swarm instance root disk size",
                                "defaultValue": "100",
                                "toolTip": "Provide the size of the Swarm root disk - The size (GB) of the Managed disk.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^\\d+$",
                                    "validationMessage": "Value must be numeric and greater than or equal to 0"
                                }
                            },
                            {
                                "name": "preUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Pre Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run before the default Swarm userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            },
                            {
                                "name": "postUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Post Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run after the default Swarm userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            }
                        ],
                        "visible": "[steps('SwarmConfig').deploySwarm]"
                    }
                ]
            },
            {
                "name": "WorkstationConfig",
                "label": "Workstation Configuration",
                "subLabel": {
                    "preValidation": "Configure the Windows Workstation's resources and settings",
                    "postValidation": "Done"
                },
                "bladeTitle": "Windows Workstation Configuration",
                "elements": [
                    {
                        "name": "deployWorkstation",
                        "type": "Microsoft.Common.OptionsGroup",
                        "label": "Deploy Windows Workstation",
                        "defaultValue": "true",
                        "toolTip": "Optionally select to deploy the Windows Workstation",
                        "constraints": {
                            "allowedValues": [
                                {
                                    "label": "true",
                                    "value": true
                                },
                                {
                                    "label": "false",
                                    "value": false
                                }
                            ]
                        }
                    },
                    {
                        "name": "vmSettings",
                        "type": "Microsoft.Common.Section",
                        "label": "Hansoft VM Settings",
                        "elements": [
                            {
                                "name": "vmSize",
                                "type": "Microsoft.Compute.SizeSelector",
                                "label": "Windows instance type",
                                "toolTip": "Select Windows Workstation VM SKU",
                                "recommendedSizes": [
                                    "Standard_D1_v2",
                                    "Standard_D2_v2",
                                    "Standard_D3_v2",
                                    "Standard_D4_v2",
                                    "Standard_D5_v2"
                                ],
                                "constraints": {
                                    "allowedSizes": [
                                        "Standard_A1_v2",
                                        "Standard_A2_v2",
                                        "Standard_A4_v2",
                                        "Standard_A8_v2",
                                        "Standard_A2m_v2",
                                        "Standard_A4m_v2",
                                        "Standard_A8m_v2",
                                        "Standard_D1_v2",
                                        "Standard_D2_v2",
                                        "Standard_D3_v2",
                                        "Standard_D4_v2",
                                        "Standard_D5_v2",
                                        "Standard_D11_v2",
                                        "Standard_D12_v2",
                                        "Standard_D13_v2",
                                        "Standard_D14_v2",
                                        "Standard_D15_v2"
                                    ]
                                },
                                "osPlatform": "Windows",
                                "count": "1",
                                "visible": true
                            },
                            {
                                "name": "adminUsername",
                                "type": "Microsoft.Compute.UserNameTextBox",
                                "label": "User name",
                                "defaultValue": "perforce",
                                "toolTip": "Specify a user for accessing the windows machines within your environment. Must be a valid Windows username",
                                "constraints": {
                                    "required": true,
                                    "regex": "^(?!(?:administrator|guest|www\\-data)$)\\w+$",
                                    "validationMessage": "Username must not be a reserved Windows username"
                                },
                                "osPlatform": "Windows"
                            },
                            {
                                "name": "adminPassword",
                                "type": "Microsoft.Compute.CredentialsCombo",
                                "label": {
                                    "password": "Password",
                                    "confirmPassword": "Confirm password"
                                },
                                "toolTip": {
                                    "password": ""
                                },
                                "constraints": {
                                    "required": true,
                                    "customPasswordRegex": "^(?=.*[A-Za-z])(?=.*\\d)[A-Za-z\\d]{12,}$",
                                    "customValidationMessage": "The password must be alphanumeric, contain at least 12 characters, and have at least 1 letter and 1 number."
                                },
                                "options": {
                                    "hideConfirmation": false
                                },
                                "osPlatform": "Windows",
                                "visible": true
                            },
                            {
                                "name": "rootDiskSize",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Windows instance root disk size",
                                "defaultValue": "150",
                                "toolTip": "Provide the size of the root disk - The size (GB) of the Managed disk.",
                                "constraints": {
                                    "required": true,
                                    "regex": "^\\d+$",
                                    "validationMessage": "Value must be numeric and greater than or equal to 0"
                                }
                            },
                            {
                                "name": "preUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Pre Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run before the default Workstation userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            },
                            {
                                "name": "postUserData",
                                "type": "Microsoft.Common.TextBox",
                                "label": "Post Userdata",
                                "defaultValue": "",
                                "toolTip": "Userdata to run after the default Workstation userdata.",
                                "placeholder": "This is a multi-line text box:\nLine 1.\nLine 2.\nLine 3.",
                                "multiLine": true,
                                "constraints": {
                                    "required": false,
                                    "validations": [
                                        {
                                            "regex": "^[a-z0-9A-Z -.:\n]{1,60}$",
                                            "message": "Only 1-60 alphanumeric characters, hyphens, spaces, periods, and colons are allowed."
                                        }
                                    ]
                                },
                                "visible": true
                            }
                        ],
                        "visible": "[steps('WorkstationConfig').deployWorkstation]"
                    }
                ]
            },
            {
                "name": "tags",
                "label": "Tags",
                "subLabel": {
                    "preValidation": "Configure the tags for resources",
                    "postValidation": "Done"
                },
                "bladeTitle": "Tags",
                "elements": [
                    {
                        "name": "tagsByResource",
                        "type": "Microsoft.Common.TagsByResource",
                        "resources": [
                            "Microsoft.Storage/storageAccounts",
                            "Microsoft.Compute/virtualMachines"
                        ]
                    }
                ]
            }
        ],
        "outputs": {
            "location": "[location()]",
            "environment": "[basics('environment')]",
            "availabilityOption": "[basics('availabilityOption')]",
            "primaryZone": "[basics('primaryZone')]",
            "secondaryZone": "[basics('secondaryZone')]",
            "vnetNewOrExisting": "[steps('VirtualNetworkConfig').virtualNetwork.newOrExisting]",
            "vnetName": "[steps('VirtualNetworkConfig').virtualNetwork.name]",
            "vnetAddressPrefixes": "[steps('VirtualNetworkConfig').virtualNetwork.addressPrefixes]",
            "publicSubnet0Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet1.name]",
            "publicSubnet0": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet1.addressPrefix]",
            "publicSubnet1Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet2.name]",
            "publicSubnet1": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet2.addressPrefix]",
            "privateSubnet0Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet3.name]",
            "privateSubnet0": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet3.addressPrefix]",
            "privateSubnet1Name": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet4.name]",
            "privateSubnet1": "[steps('VirtualNetworkConfig').virtualNetwork.subnets.subnet4.addressPrefix]",
            "vnetResourceGroupName": "[steps('VirtualNetworkConfig').virtualNetwork.resourceGroup]",
            "nsgIPRangeToPermit": "[steps('VirtualNetworkConfig').ipRangeToPermitFrom]",
            "p4AdminUser": "[steps('PerforceServerConfig').linuxCredential.adminUsername]",
            "p4VMSize": "[steps('PerforceServerConfig').p4VMSize]",
            "p4SSHType": "[steps('PerforceServerConfig').linuxCredential.p4SSHType]",
            "p4AdminKeyID": "[steps('PerforceServerConfig').linuxCredential.adminExistKey.id]",
            "authenticationType": "[steps('PerforceServerConfig').linuxCredential.adminPublicKey.authenticationType]",
            "adminPasswordOrKey": "[steps('PerforceServerConfig').linuxCredential.adminPublicKey.sshPublicKey)]",
            "deployFromScratchOrSnapshot": "[steps('PerforceServerConfig').deployFromScratchOrSnapshot]",
            "p4SnapshotIDArchive": "[steps('PerforceServerConfig').p4SnapshotIDArchive.id]",
            "p4SnapshotIDJournal": "[steps('PerforceServerConfig').p4SnapshotIDJournal.id]",
            "p4SnapshotIDLog": "[steps('PerforceServerConfig').p4SnapshotIDLog.id]",
            "p4SnapshotIDMetadata": "[steps('PerforceServerConfig').p4SnapshotIDMetadata.id]",
            "depotDiskType": "[steps('PerforceServerConfig').depotDiskType]",
            "depotDiskSize": "[steps('PerforceServerConfig').depotDiskSize]",
            "logDiskType": "[steps('PerforceServerConfig').logDiskType]",
            "logDiskSize": "[steps('PerforceServerConfig').logDiskSize]",
            "metadataDiskType": "[steps('PerforceServerConfig').metadataDiskType]",
            "metadataDiskSize": "[steps('PerforceServerConfig').metadataDiskSize]",
            "journalDiskType": "[steps('PerforceServerConfig').journalDiskType]",
            "journalDiskSize": "[steps('PerforceServerConfig').journalDiskSize]",
            "p4PreUserData": "[steps('PerforceServerConfig').p4PreUserData]",
            "p4PostUserData": "[steps('PerforceServerConfig').p4PostUserData]",
            "deployHansoft": "[steps('HansoftConfig').deployHansoft]",
            "hansoftVMSize": "[steps('HansoftConfig').vmSettings.vmSize]",
            "hansoftRootDiskSize": "[steps('HansoftConfig').vmSettings.rootDiskSize]",
            "hansoftPreUserData": "[steps('HansoftConfig').vmSettings.preUserData]",
            "hansoftPostUserData": "[steps('HansoftConfig').vmSettings.postUserData]",
            "deploySwarm": "[steps('SwarmConfig').deploySwarm]",
            "swarmVMSize": "[steps('SwarmConfig').vmSettings.vmSize]",
            "swarmRootDiskSize": "[steps('SwarmConfig').vmSettings.rootDiskSize]",
            "swarmPreUserData": "[steps('SwarmConfig').vmSettings.preUserData]",
            "swarmPostUserData": "[steps('SwarmConfig').vmSettings.postUserData]",
            "deployWorkstation": "[steps('WorkstationConfig').deployWorkstation]",
            "workstationVMSize": "[steps('WorkstationConfig').vmSettings.vmSize]",
            "workstationAdminUser": "[steps('WorkstationConfig').vmSettings.adminUsername]",
            "workstationAdminPassword": "[steps('WorkstationConfig').vmSettings.adminPassword.password]",
            "workstationRootDiskSize": "[steps('WorkstationConfig').vmSettings.rootDiskSize]",
            "workstationPreUserData": "[steps('WorkstationConfig').vmSettings.preUserData]",
            "workstationPostUserData": "[steps('WorkstationConfig').vmSettings.postUserData]",
            "tagsByResource": "[steps('tags').tagsByResource]"
        }
    }
}